#summary Instructions for using CoreAVC with mplayer

= Introduction =

CoreAVC can be used with mplayer in 2 ways:
 * Use dshowserver and apply the dshowserver patch to mplayer (x86_64 and ia32)
 * Patch mplayer Win32 dshow code to support CoreAVC (ia32 only)

The mplayer build does not support interlaced playback (it will fail rather than just look bad)

The following details the direct-patch method.  The dshowserver method [MplayerInstallation] is recommended instead, however it is still under development, and does not yet work with Windows or Mac.  For those platforms, use these instructions instead.
dshowserver method.  It is the recommended way to use CoreAVC, but is still under development, and does not yet work with Windows or Mac.  For those platforms, use the direct-patch method [MplayerInstallationAlt]

= Details =

Before beginning, ensure that you have a recent mplayer build (only SVN is supported, but recent snapshots should work as well.  1.0RC1 apparently does not) and have run './configure' on it.  This is important as the patch will not apply cleanly to an unconfigured mplayer.

1) Download the code from svn:
{{{
svn checkout http://coreavc-for-linux.googlecode.com/svn/trunk/ coreavc-for-linux 
cd coreavc-for-linux
}}}

2) Build mplayer patch:
{{{
./mplayer/build_patch.pl <path to mplayer source code> > mplayerfull.patch
}}}

3) Install patch into mplayer:
{{{
cd <path to mplayer source code>
patch -p0 < <path to coreavc-for-linux>/mmplayerfull.patch
make
make install
cp loader/registercodec /usr/local/bin/
}}}

4) Update codecs.conf
  * If you don't have ~/.mplayer/codecs.conf
{{{
mkdir ~/.mplayer
cp <path to mplayer source>/etc/codecs.conf ~/.mplayer/
}}}
  * Add the following to the end of ~/.mplayer/codecs.conf
{{{
videocodec coreavc13
  info "CoreAVC DShow H264 decoder 1.3 for x86 - http://corecodec.org/"
  status working
  format 0x10000005
  fourcc H264,h264 H264
  fourcc X264,x264
  fourcc avc1,AVC1 AVC1
  fourcc davc,DAVC
  fourcc VSSH
  driver dshow
  dll "CoreAVCDecoder.ax"
  guid 0x09571a4b, 0xf1fe, 0x4c60, 0x97, 0x60, 0xde, 0x6d, 0x31, 0x0c, 0x7c, 0x31
  out YV12,IYUV,I420,YUY2
}}}

5) Install CoreAVC to /usr/lib/win32/CoreAVCDecoder.ax

6) Install CoreAVC license info as documented in [RegisterCoreAVC]
  * NOTE: registercodec doesn't build with current mplayer SVN due to changes in the build process.  To build it, do this"
  {{{
cd loader && gcc -I. -I.. -o registercodec modify_reg.c
}}}

= Playing tips =

to use coreavc, you may need to add '-vc coreavc13' (assuming you use the above codecs.conf options)

you may also need to use '-demuxer lavf' for some formats (TS streams for example)

with current mplayer you may also need -no-correct-pts to prevent jerky playback.